# Tổng quan về Open vSwitch

## Tổng quan

- Cũng giống như Linux Bridge, OpenVSwitch là phần mềm cung cấp virtual switch cho các giải pháp ảo hóa network.
- Là phần mềm mã nguồn mở, sử dụng cho ảo hóa vswitch trong môi trường ảo hóa của server.
- Open Vswitch có thể forwards traffic giữa các máy VM trên cùng một máy chủ vật lý và forwards traffic giữa các máy VM và máy vật lý.
- OpenVSwitch được thiết kế tương thích với các switch hiện đại.
- Open vSwitch phù hợp làm việc như là một switch ảo trong môi trường máy ảo VM. Ngoài việc kiểm soát và có khả năng hiển thị giao diện chuẩn cho các lớp mạng ảo, nó được thiết kế để hỗ trợ phân phối trên nhiều máy chủ vật lý. Open vSwitch hỗ trợ nhiều công nghệ ảo hóa Linux-based như là Xen/Xen server, KVM và Virtual Box.
- OpenVSwitch có thể chạy trên các nền tảng Linux, FreeBSD, Windows, non-POSIX embedded Systems,...


## Các tính năng

Phiên bản hiện tại của Open vSwitch hỗ trợ những tính năng sau:
- Hỗ trợ tính năng VLAN chuẩn 802.1Q với các cổng trunk và access như một switch layer thông thường.
- Hỗ trợ giao diện NIC bonding có hoặc không có LACP trên cổng uplink switch.
- Hỗ trợ NetFlow, sFlow(R), và mirroring để tăng khả năng hiển thị.
- Hỗ trợ cấu hình QoS (Quality of Service) và các chính sách thêm vào khác.
- Hỗ trợ tạo tunnel GRE, VXLAN, STT và LISP.
- Hố trợ tính năng quản lý các kết nối 802.1aq
- Hỗ trợ OpenFlow các phiên bản từ 1.0 trở lên.
- Cấu hình cơ sở dữ liệu với C và Python.
- Hoạt động forwarding với hiệu suất cao sử dụng module trong nhân Linux.


## Các thành phần

- ovs-vswitchd: đóng vai trò daemon switch thực hiện các chức năng chuyển mạch kết hợp với module trong kernel Linux cho flow-based swtiching.
- ovsdb-server: Database server mà ovs-vswitchd truy vấn tới để lấy cấu hình.
- ovs-dpctl: Công cụ cấu hình module chuyển mạch trong kernel.
- ovs-vsctl: Công cụ thực hiện truy vấn và cập nhật các cấu hình của ovs-vswitchd.
- ovs-appctl: Công cụ gửi các lệnh tới Open Vswitch deamon. Open vSwitch cũng cung cấp một số công cụ sau:
- ovs-ofctl: Công cụ truy vấn và điều khiển chuyển mạch Open Flow và controller.
- ovs-pki: Công cụ cho phép tạo và quản lý các public-key cho các Open Flow switch.
- ovs-testcontroller: một OpenFlow controller đơn giản có thể quản lý một số switch ảo thông qua giao thức Open Flow, khiến chúng hoạt động như các switch lớp 2 hoặc như hub. Phù hợp để kiểm tra các mạng Open Flow ban đầu.

![](/docs/ovs-network/images/1-intro-openvswitch/pic1.png)

![](/docs/ovs-network/images/1-intro-openvswitch/pic2.png)

Kiến trúc OpenvSwitch Architecture

![](/docs/ovs-network/images/1-intro-openvswitch/pic3.jpg)

## Concept

- Packet: The smallest unit of data forwarded by the network. Each packet comes from a certain port and will eventually be sent to one or more destination ports. The process of forwarding data packets is the only function of the network.

- Bridge: The bridge in OpenvSwitch corresponds to a physical switch, and its function is to forward data packets received from a port to another or multiple ports according to certain flow rules.

- Port: The port is the unit for sending and receiving data packets. In OpenvSwitch, each port belongs to a specific bridge. The data packets received by the port will be processed by the flow rules and sent to other ports; the data packets from other ports will also be sent out. The main ones are

Type Port:
- Normal: The user can bind the network card in the operating system to ovs, and ovs will generate a common port to process the data packets in and out of this network card.
- Internal: When the port type is internal, ovs will create a virtual network card, all data packets received by the port will be delivered to the network card, and the sent packets will be delivered to ovs through the port. When ovs creates a new bridge, it will create an Internal Port with the same name as the bridge by default.
- Patch: When there are multiple ovs bridges in the machine, you can use Patch Port to connect the two bridges. Patch Ports always appear in pairs, connected to two bridges, and exchange data between the two bridges.
- Tunnel: The tunnel port is a virtual port that supports the use of gre or vxlan tunnel technology to communicate with remote ports located elsewhere on the network.

- Interface: The interface is the component that ovs exchanges with the outside world. An interface is a network card of the operating system. This network card may be a virtual network card generated by ovs, a physical network card may be mounted on ovs, or a virtual network card (TUN/TAP) of the operating system may be mounted on ovs.

## Tham khảo

https://docs.openvswitch.org/en/latest/intro/install/general/

https://github.com/hocchudong/thuctap012017/blob/master/TamNT/Virtualization/docs/Virtual_Switch/2.Tim_hieu_Open_Vswitch.md

https://blog.csdn.net/x_i_y_u_e/article/details/56011074